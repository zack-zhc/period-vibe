# Period Vibe - 产品需求文档 (PRD)

## 1. 产品概述

### 1.1 产品定位
Period Vibe 是一款轻量化的生理期记录与管理应用，专注于为女性用户提供简洁、直观、易用的生理周期追踪体验。

### 1.2 目标用户
- 18-45岁女性用户
- 需要记录和追踪生理周期的用户
- 追求简洁高效操作体验的用户

### 1.3 核心价值主张
- **极简设计**：去除冗余功能，专注核心需求
- **轻量化**：安装包小，运行流畅，不占用过多系统资源
- **易用性**：操作直观，学习成本低，3步完成核心操作

---

## 2. 产品功能需求

### 2.1 核心功能模块

#### 2.1.1 首页（周期概览）
**功能描述**：展示当前周期状态和关键信息

**具体需求**：
- 显示当前周期天数（第X天）
- 显示距离下次生理期的预计天数
- 显示当前周期状态标签（经期、排卵期、安全期、易孕期）
- 快速记录按钮（记录今日状态）
- 日历视图切换入口
- 历史记录入口

**设计方案**：
- 采用卡片式布局，信息层次清晰
- 使用渐变色背景区分不同周期状态
- 核心信息使用大字号显示，一目了然
- 快速记录按钮固定在底部，单手可操作

#### 2.1.2 日历视图
**功能描述**：以日历形式展示周期历史和预测

**具体需求**：
- 月视图日历展示
- 标记已记录的经期日期（红色圆点）
- 标记预测的经期日期（浅红色背景）
- 标记排卵期（蓝色圆点）
- 点击日期可查看/编辑当日记录
- 支持月份切换
- 显示当前选中日期的周期状态
- **智能操作卡片**：根据选中日期的上下文显示相关操作
  - 周期内有记录：显示"编辑记录"和"结束周期"按钮
  - 周期内无记录：显示"记录今日"和"结束周期"按钮
  - 周期外有记录：显示"编辑记录"和"开始周期"按钮
  - 周期外无记录：显示"开始周期"和"记录症状"按钮
- **图例对话框**：通过顶部操作栏的信息图标访问
  - 显示四个图例项：已记录经期、预测经期、排卵期、易孕期
  - 点击图标弹出对话框，点击关闭按钮或外部区域关闭
- **空选择提示卡片**：未选择日期时显示引导信息
  - 显示日历图标和提示文字
  - 引导用户点击日期查看详情

**设计方案**：
- 日历网格布局，7列6行
- 使用颜色编码区分不同状态
- 当前日期高亮显示
- 点击日期显示智能操作卡片，根据上下文提供相应操作
- 未选择日期时显示空选择提示卡片，避免空白区域突兀
- 图例通过顶部操作栏的信息图标访问，保持界面简洁
- 智能操作卡片与空选择提示卡片使用一致的设计风格

#### 2.1.3 记录功能
**功能描述**：记录每日生理状态和相关症状

**具体需求**：
- 记录经期开始/结束
- 记录经量（少、中、多）
- 记录症状（可选）：
  - 腹痛/腰痛
  - 情绪波动
  - 乳房胀痛
  - 头痛
  - 疲劳
  - 其他（自定义备注）
- 记录日期选择（默认今日）
- 支持编辑历史记录
- 智能判断当前日期是否有记录，自动填充已有数据

**设计方案**：
- 底部弹出式表单
- 智能判断当前状态（是否在周期中），显示不同选项：
  - **不在周期中**：提供"开始新周期"和"记录症状"两个选项
  - **在周期中**：默认记录经期状态，自动关联当前周期
- 使用标签选择经量，点击即可选择
- 症状使用复选框，快速勾选
- 备注使用文本输入框，可选填
- 保存按钮固定在底部
- 编辑模式下显示"编辑记录"标题，自动填充已有数据

#### 2.1.4 周期预测
**功能描述**：基于历史数据预测未来周期

**具体需求**：
- 自动计算平均周期长度
- 预测下次经期开始日期
- 预测排卵期窗口
- 预测易孕期
- 显示预测准确度（基于历史数据量）
- 支持手动调整预测参数

**设计方案**：
- 使用最近3-6次周期数据计算平均值
- 显示预测范围（±2天）
- 在日历中用不同颜色标记预测日期
- 提供设置入口调整算法参数

#### 2.1.5 历史记录
**功能描述**：查看和管理历史周期记录

**具体需求**：
- 列表展示历史周期
- 每个周期显示：
  - 开始日期
  - 持续天数
  - 周期长度
  - 平均经量
- 点击周期展开详细记录
- 支持删除历史记录
- 支持导出数据（CSV格式）

**设计方案**：
- 时间轴式列表展示
- 使用卡片分组展示每个周期
- 长按显示删除选项
- 导出功能在设置中提供

#### 2.1.6 提醒功能
**功能描述**：在关键日期发送提醒通知

**具体需求**：
- 经期开始提醒（提前1-3天）
- 经期结束提醒
- 排卵期提醒
- 易孕期提醒
- 记录提醒（每日提醒记录状态）
- 支持自定义提醒时间
- 支持开关各类提醒

**设计方案**：
- 使用Android系统通知
- 通知内容简洁明了
- 点击通知直接跳转到记录页面
- 在设置中管理提醒选项

#### 2.1.7 数据统计
**功能描述**：展示周期健康数据统计

**具体需求**：
- 显示平均周期长度
- 显示平均经期天数
- 显示最长/最短周期
- 显示周期规律性评分
- 显示记录天数统计
- 图表展示周期趋势（折线图）

**设计方案**：
- 使用卡片展示关键指标
- 使用图表库绘制趋势图
- 数据按月/季/年切换查看
- 提供数据解读说明

#### 2.1.8 设置
**功能描述**：管理应用设置和数据

**具体需求**：
- 周期参数设置：
  - 周期长度范围（默认21-35天）
  - 经期长度范围（默认3-7天）
  - 排卵期算法选择
- 提醒设置：
  - 提醒时间设置
  - 提醒类型开关
- 数据管理：
  - 导出数据
  - 导入数据
  - 清除数据
- 主题设置：
  - 浅色/深色模式
  - 主题色选择
- 隐私设置：
  - 应用锁（指纹/密码）
  - 隐私模式（隐藏通知内容）
- 关于：
  - 版本信息
  - 隐私政策
  - 用户协议

**设计方案**：
- 分组列表展示设置项
- 使用开关、滑块、选择器等控件
- 关键操作需二次确认
- 数据导出/导入支持文件选择

---

## 3. 页面架构

### 3.1 页面结构总览

Period Vibe 采用简洁的单页面应用架构，通过底部导航栏和弹窗实现页面切换，共包含 **6个主要页面/界面**：

```
应用启动
    │
    ├─► 首次使用？ ─是─► 欢迎引导页 ──► 初始设置页 ──► 首页
    │
    └─否──────────────────────────────────────► 首页
                                                    │
                    ┌───────────────────────────────┼───────────────────────────────┐
                    │                               │                               │
                    ▼                               ▼                               ▼
              日历视图页                       历史记录页                       设置页
                    │                               │                               │
                    ▼                               ▼                               ▼
              记录弹窗（底部弹出）               记录弹窗（底部弹出）          统计页（子页面）
```

### 3.2 页面详细说明

#### 3.2.1 欢迎引导页（Welcome Screen）
- **页面类型**：全屏引导页
- **访问路径**：首次启动应用
- **页面元素**：
  - 应用Logo和名称
  - 简短的功能介绍（3-4个滑动页面）
  - "开始使用"按钮
- **导航方式**：左右滑动切换引导内容，点击按钮进入设置页
- **显示条件**：仅首次使用时显示

#### 3.2.2 初始设置页（Initial Setup）
- **页面类型**：表单页
- **访问路径**：欢迎引导页 → 初始设置页
- **页面元素**：
  - 上次经期开始日期选择器（可选）
  - 平均周期长度输入（默认28天）
  - 平均经期天数输入（默认5天）
  - "完成"按钮
- **导航方式**：填写完成后点击"完成"进入首页
- **显示条件**：仅首次使用时显示
- **特殊说明**：
  - 上次经期开始日期为可选字段，用户可以选择不填写
  - 不选择日期时，应用将使用默认周期参数，不进行周期预测
  - 选择日期时，应用将基于该日期和周期参数进行周期预测
  - 不选择日期时，页面UI会显示提示信息，告知用户后续可以随时记录

#### 3.2.3 首页（Home Screen）
- **页面类型**：主页面
- **访问路径**：应用启动后默认页面，底部导航栏"首页"标签
- **页面元素**：
  - 顶部：当前周期状态卡片
    - 周期天数（大字号显示）
    - 距离下次经期天数
    - 周期状态标签（经期/排卵期/安全期/易孕期）
  - 中部：快捷操作区
    - 快速记录按钮（FAB，固定右下角）
    - 今日记录摘要
  - 底部：导航栏（4个标签：首页、日历、历史、设置）
- **导航方式**：
  - 点击底部导航栏切换到其他页面
  - 点击快速记录按钮：
    - **有当前周期时**：显示菜单，包含"结束周期"和"修改记录"两个选项
    - **无当前周期时**：显示菜单，包含"新建周期"和"记录症状"两个选项
- **显示条件**：每次打开应用默认显示

#### 3.2.4 日历视图页（Calendar Screen）
- **页面类型**：日历展示页
- **访问路径**：底部导航栏"日历"标签
- **页面元素**：
  - 顶部：月份切换按钮（上个月/下个月）、图例信息图标
  - 中部：月视图日历网格（7列6行）
    - 已记录经期日期：红色圆点
    - 预测经期日期：浅红色背景
    - 排卵期：蓝色圆点
    - 当前日期：高亮边框
  - 底部：选中日期的状态信息卡片
    - **智能操作卡片**（选中日期时显示）：
      - 日期头部：显示完整日期和"今天"标签
      - 状态信息：根据上下文显示周期状态或已有记录
      - 操作按钮：根据上下文显示相应操作
        - 周期内有记录：编辑记录、结束周期
        - 周期内无记录：记录今日、结束周期
        - 周期外有记录：编辑记录、开始周期
        - 周期外无记录：开始周期、记录症状
    - **空选择提示卡片**（未选中日期时显示）：
      - 日历图标和提示文字
      - 引导用户点击日期查看详情
  - 底部导航栏
- **导航方式**：
  - 点击月份切换按钮切换月份
  - 左右滑动切换月份
  - 点击日期显示智能操作卡片
  - 点击智能操作卡片中的按钮触发相应操作
  - 点击图例信息图标显示图例对话框
  - 点击底部导航栏切换到其他页面

#### 3.2.5 记录弹窗（Record Bottom Sheet）
- **页面类型**：底部弹出式表单
- **访问路径**：首页快速记录按钮、日历点击日期、历史记录页展开后点击编辑按钮
- **智能判断逻辑**：
  - 根据当前用户状态（是否在周期中）自动显示不同的记录选项
  - 上下文感知，减少用户操作步骤
  - 自动检测当前日期是否有记录，如有则自动填充数据并显示"编辑记录"标题
- **场景1：当前不在周期中**
  - **页面元素**：
    - 顶部：日期选择器（默认今日）
    - 中部：记录类型选择
      - 【开始新周期】按钮
        - 经量选择（少/中/多）
        - 症状复选框（腹痛、情绪波动、乳房胀痛、头痛、疲劳）
        - 备注输入框（可选）
      - 【记录症状】按钮
        - 症状复选框（腹痛、情绪波动、乳房胀痛、头痛、疲劳）
        - 备注输入框（可选）
    - 底部：取消/保存按钮
  - **数据关联**：
    - 选择"开始新周期"：创建新Cycle，记录自动关联到新Cycle
    - 选择"记录症状"：记录cycleId=null（等待周期分配）
- **场景2：当前在周期中**
  - **页面元素**：
    - 顶部：日期选择器（默认今日）
    - 中部：表单内容
      - 周期信息显示："周期第X天"（自动计算）
      - 经量选择（少/中/多）
      - 症状复选框（腹痛、情绪波动、乳房胀痛、头痛、疲劳）
      - 备注输入框（可选）
    - 底部：取消/保存按钮
  - **数据关联**：
    - 记录自动关联到当前活跃Cycle
- **编辑模式**：
  - 当选中日期已有记录时，自动填充已有数据（日期、经量、症状、备注）
  - 标题显示"编辑记录"
  - 保存时更新已有记录
- **导航方式**：
  - 点击保存后关闭弹窗并更新数据
  - 点击取消或点击外部区域关闭弹窗
- **显示条件**：点击记录按钮或日历日期或历史记录编辑按钮时弹出

#### 3.2.6 历史记录页（History Screen）
- **页面类型**：列表展示页
- **访问路径**：底部导航栏"历史"标签
- **页面元素**：
  - 顶部：页面标题"历史记录"
  - 中部：历史周期列表（时间轴样式）
    - 每个周期卡片显示：
      - 开始日期
      - 持续天数
      - 周期长度
      - 平均经量
    - 展开后的详细记录：
      - 周期统计卡片
      - 每日记录列表
  - 底部导航栏
- **导航方式**：
  - 点击周期卡片展开/收起详细记录
  - 长按周期卡片显示删除菜单
  - 展开后可点击编辑按钮弹出记录弹窗
  - 点击底部导航栏切换到其他页面

#### 3.2.7 数据统计页（Statistics Screen）
- **页面类型**：数据展示页（子页面）
- **访问路径**：设置页 → 数据统计
- **页面元素**：
  - 顶部：返回按钮、页面标题"数据统计"
  - 中部：统计卡片
    - 平均周期长度
    - 平均经期天数
    - 最长/最短周期
    - 周期规律性评分
    - 记录天数统计
  - 底部：周期趋势图表（折线图）
  - 时间范围切换（月/季/年）
- **导航方式**：
  - 点击返回按钮返回设置页
  - 切换时间范围查看不同统计数据

#### 3.2.9 设置页（Settings Screen）
- **页面类型**：列表设置页
- **访问路径**：底部导航栏"设置"标签
- **页面元素**：
  - 顶部：页面标题"设置"
  - 中部：分组设置列表
    - 周期参数设置
    - 提醒设置
    - 数据管理
    - 主题设置
    - 隐私设置
    - 关于
  - 底部导航栏
- **导航方式**：
  - 点击设置项进入对应设置子页面或弹窗
  - 点击"数据统计"进入统计页
  - 点击底部导航栏切换到其他页面

### 3.3 页面导航关系表

| 页面 | 导航到 | 触发方式 |
|------|--------|----------|
| 欢迎引导页 | 初始设置页 | 点击"开始使用"按钮 |
| 初始设置页 | 首页 | 点击"完成"按钮 |
| 首页 | 日历视图页 | 点击底部导航栏"日历" |
| 首页 | 历史记录页 | 点击底部导航栏"历史" |
| 首页 | 设置页 | 点击底部导航栏"设置" |
| 首页 | 记录弹窗 | 点击快速记录按钮 |
| 日历视图页 | 首页 | 点击底部导航栏"首页" |
| 日历视图页 | 历史记录页 | 点击底部导航栏"历史" |
| 日历视图页 | 设置页 | 点击底部导航栏"设置" |
| 日历视图页 | 记录弹窗 | 点击日历日期 |
| 历史记录页 | 首页 | 点击底部导航栏"首页" |
| 历史记录页 | 日历视图页 | 点击底部导航栏"日历" |
| 历史记录页 | 设置页 | 点击底部导航栏"设置" |
| 设置页 | 首页 | 点击底部导航栏"首页" |
| 设置页 | 日历视图页 | 点击底部导航栏"日历" |
| 设置页 | 历史记录页 | 点击底部导航栏"历史" |
| 设置页 | 数据统计页 | 点击"数据统计" |
| 数据统计页 | 设置页 | 点击返回按钮 |

### 3.4 页面层级结构

```
Period Vibe 应用
├── 欢迎引导页（仅首次）
├── 初始设置页（仅首次）
└── 主应用界面
    ├── 首页（主页面）
    │   └── 记录弹窗（子界面）
    ├── 日历视图页（主页面）
    │   └── 记录弹窗（子界面）
    ├── 历史记录页（主页面）
    │   └── 记录弹窗（子界面）
    └── 设置页（主页面）
        └── 数据统计页（子页面）
```

### 3.5 页面数量统计

- **主页面**：4个（首页、日历视图页、历史记录页、设置页）
- **引导页面**：2个（欢迎引导页、初始设置页，仅首次显示）
- **子页面/弹窗**：2个（记录弹窗、数据统计页）
- **总计**：6个独立页面/界面（不含首次引导）

---

## 4. 用户界面设计规范

### 4.1 设计原则
- **简洁至上**：每个页面只展示必要信息，避免视觉干扰
- **一致性**：统一的色彩、字体、图标风格
- **可访问性**：符合Android无障碍设计规范
- **响应式**：适配不同屏幕尺寸和方向

### 3.2 色彩系统
- **主色调**：柔和的粉色系（#FF8BA7），传递温暖、关怀的感觉
- **经期标记色**：红色（#FF6B6B）
- **排卵期标记色**：蓝色（#4ECDC4）
- **安全期标记色**：绿色（#95E1D3）
- **背景色**：浅灰/白色（#F7F9FC）
- **文字色**：深灰（#2D3436）
- **辅助色**：浅灰（#B2BEC3）

### 4.3 字体规范
- **标题**：Roboto Bold，20-24sp
- **副标题**：Roboto Medium，16-18sp
- **正文**：Roboto Regular，14-16sp
- **辅助文字**：Roboto Regular，12-14sp

### 3.4 图标规范
- 使用Material Design图标
- 统一使用线性图标风格
- 图标尺寸：24dp
- 图标颜色：与文字色一致

### 3.5 间距规范
- 页面边距：16dp
- 卡片间距：12dp
- 元素间距：8dp
- 按钮高度：48dp
- 卡片圆角：12dp

### 4.6 交互设计
- **点击反馈**：所有可点击元素有涟漪效果
- **过渡动画**：页面切换使用淡入淡出，时长200ms
- **手势操作**：支持左右滑动切换月份
- **长按操作**：长按显示删除/编辑菜单

---

## 4. 技术实现方案

### 4.1 技术栈
- **开发语言**：Kotlin
- **UI框架**：Jetpack Compose
- **架构模式**：MVVM + Clean Architecture
- **本地存储**：Room Database
- **依赖注入**：Hilt
- **状态管理**：StateFlow + ViewModel
- **导航**：Compose Navigation
- **图表库**：Vico（轻量级图表库）
- **通知**：Android Notification Manager + WorkManager

### 4.2 数据模型
```kotlin
// 周期记录
data class Cycle(
    val id: Long,
    val startDate: LocalDate,           // 周期开始日期（必填）
    val endDate: LocalDate?,             // 周期结束日期（下一个周期开始时填充）
    val cycleLength: Int?,               // 周期长度（下一个周期开始时计算）
    val periodLength: Int?,              // 经期长度（经期结束时更新）
    val isCompleted: Boolean = false     // 周期是否完成
)

// 每日记录
data class DailyRecord(
    val id: Long,
    val cycleId: Long?,                  // 关联的周期ID（可能为null，等待周期分配）
    val date: LocalDate,
    val isPeriod: Boolean,
    val flowLevel: FlowLevel?, // 少、中、多
    val symptoms: List<Symptom>,
    val notes: String?
)

// 预测数据
data class Prediction(
    val nextPeriodStart: LocalDate,
    val nextPeriodEnd: LocalDate,
    val ovulationWindow: ClosedRange<LocalDate>,
    val fertileWindow: ClosedRange<LocalDate>,
    val confidence: Float
)
```

**数据模型设计说明**：

1. **Cycle（周期记录）**：
   - `startDate`：周期开始日期，创建时确定
   - `endDate`：周期结束日期，下一个周期开始时自动填充
   - `cycleLength`：周期长度，下一个周期开始时计算（从上一个周期开始到当前周期开始的天数）
   - `periodLength`：经期长度，用户标记经期结束时更新
   - `isCompleted`：周期是否完成，用于区分当前周期和历史周期

2. **DailyRecord（每日记录）**：
   - `cycleId`：关联的周期ID，可能为null（在周期未确定时）
   - 每日记录通过日期匹配自动关联到对应周期

3. **业务流程**：
   - **周期开始时**：创建新的Cycle，startDate为当前日期，其他字段为null
   - **经期结束时**：更新当前Cycle的periodLength
   - **下一个周期开始时**：自动完成上一个周期（填充endDate和cycleLength），创建新Cycle

### 4.3 核心算法
**周期预测算法**：
1. 收集最近6次周期数据
2. 计算平均周期长度和标准差
3. 使用加权平均预测下次周期
4. 排卵期 = 下次经期开始日期 - 14天
5. 易孕期 = 排卵期前后各3天

**规律性评分算法**：
- 计算周期长度的变异系数（CV）
- CV < 10%：非常规律
- CV 10-20%：规律
- CV 20-30%：不太规律
- CV > 30%：不规律

### 4.4 性能优化
- 使用Compose的remember和derivedStateOf优化重组
- 数据库查询使用Flow实现响应式更新
- 图片资源使用WebP格式压缩
- 使用LazyColumn实现列表虚拟化

---

## 5. 非功能性需求

### 5.1 性能要求
- 应用启动时间 < 2秒
- 页面切换流畅度 > 60fps
- 应用安装包 < 10MB
- 内存占用 < 100MB

### 5.2 兼容性要求
- 最低支持Android 7.0 (API 24)
- 适配不同屏幕尺寸（4.5寸-6.7寸）
- 支持横竖屏切换
- 支持深色模式

### 5.3 安全性要求
- 数据本地存储，不上传云端
- 支持应用锁保护隐私
- 数据导出时加密处理
- 遵守GDPR隐私规范

### 5.4 可维护性要求
- 代码模块化，职责清晰
- 遵循Kotlin代码规范
- 关键功能添加单元测试
- 代码注释覆盖率 > 30%

---

## 6. 用户流程

### 6.1 首次使用流程
1. 用户打开应用
2. 显示欢迎页，介绍核心功能
3. 引导用户设置初始信息：
   - 上次经期开始日期
   - 平均周期长度（可选，默认28天）
   - 平均经期天数（可选，默认5天）
4. 进入首页，显示当前周期状态

### 6.2 日常记录流程
1. 用户打开应用
2. 首页显示今日状态
3. 点击底部"记录"按钮
4. 选择今日状态（经期/非经期）
5. 选择经量（如适用）
6. 勾选症状（可选）
7. 点击保存
8. 返回首页，状态已更新

### 6.3 查看历史流程
1. 用户打开应用
2. 点击"历史记录"入口
3. 浏览历史周期列表
4. 点击某个周期查看详情
5. 可编辑或删除记录

---

## 7. 版本规划

### 7.1 MVP版本（v1.0）
- 首页周期概览
- 日历视图
- 基础记录功能（经期开始/结束、经量）
- 简单周期预测
- 历史记录查看
- 基础提醒功能

### 7.2 v1.1（迭代优化）
- 症状记录功能
- 数据统计功能
- 深色模式
- 应用锁
- 数据导出功能

### 7.3 v1.2（功能增强）
- 图表展示
- 周期规律性评分
- 自定义备注
- 提醒时间自定义
- 主题色选择

### 7.4 v2.0（重大更新）
- 机器学习预测算法
- 健康建议推送
- 多语言支持
- Widget小组件
- 数据备份到云端（可选）

---

## 8. 成功指标

### 8.1 用户指标
- 日活跃用户数 (DAU)
- 月活跃用户数 (MAU)
- 用户留存率（次日、7日、30日）
- 平均会话时长

### 8.2 功能指标
- 记录完成率
- 预测准确率（用户反馈）
- 提醒打开率
- 功能使用频率

### 8.3 性能指标
- 应用崩溃率 < 0.5%
- ANR率 < 0.1%
- 应用评分 > 4.5星

---

## 9. 风险与应对

### 9.1 技术风险
- **风险**：周期预测准确度不足
- **应对**：提供手动调整功能，持续优化算法

### 9.2 隐私风险
- **风险**：用户担心数据泄露
- **应对**：明确数据本地存储政策，提供应用锁，遵守隐私法规

### 9.3 竞争风险
- **风险**：市场上已有成熟竞品
- **应对**：聚焦简洁易用的差异化定位，快速迭代优化用户体验

---

## 10. 附录

### 10.1 竞品分析
- **Clue**：功能全面但复杂，适合专业用户
- **Flo**：社区功能丰富，但广告较多
- **Period Tracker**：简单但界面陈旧
- **Period Vibe**：简洁轻量，操作直观，填补市场空白

### 10.2 用户调研计划
- 目标用户访谈（10-15人）
- 问卷调查（100+样本）
- 可用性测试（5-8人）
- A/B测试（关键功能）

---

## 11. 更新日志

### v1.1 (2026-01-19)
**新增功能**：
- 日历视图智能操作卡片
  - 根据选中日期的上下文显示相应操作
  - 四种上下文场景：周期内有记录、周期内无记录、周期外有记录、周期外无记录
  - 操作按钮：编辑记录、结束周期、记录今日、开始周期、记录症状
- 日历视图图例对话框
  - 通过顶部操作栏的信息图标访问
  - 显示四个图例项：已记录经期、预测经期、排卵期、易孕期
  - 保持界面简洁，避免图例卡片占用空间
- 空选择提示卡片
  - 未选择日期时显示引导信息
  - 包含日历图标和提示文字
  - 避免空白区域显得突兀

**优化改进**：
- 移除日历日期点击时直接显示记录弹窗的逻辑
- 所有记录操作通过智能操作卡片进行，提供上下文感知的用户体验
- 智能操作卡片与空选择提示卡片使用一致的设计风格

**技术实现**：
- 新增CalendarViewModel状态管理：showLegendDialog
- 新增SmartActionCard组件实现智能上下文操作
- 新增EmptySelectionCard组件实现空选择提示
- 新增LegendDialog组件实现图例对话框
- 更新CalendarScreen集成新组件

---

**文档版本**：v1.1
**创建日期**：2025-12-30
**最后更新日期**：2026-01-19
**作者**：资深产品经理
**状态**：已实现
